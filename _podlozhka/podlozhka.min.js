/*! Podlozhka v1.0.0 | (c) 2014 Michael Danilov <https://github.com/MichaelDanilov/podlozhka> */
!function(a){"use strict";var b=a("body").children(),c={},d={},e={},f={};f.changeImgPositions=function(a,b){d.x.val(parseFloat(a)),d.y.val(parseFloat(b))},c.html='<div class="dnlv-podlozhka__body"></div><div class="dnlv-podlozhka__img"></div><div class="dnlv-podlozhka__form dnlv-podlozhka-twbs"><div class="modal-content"><div class="modal-header"><div class="on-off"><span class="icon-off"></span></div><h4 class="modal-title">Podlozhka</h4></div><div class="modal-body"><div class="form-group"><label for="dnlv-podlozhka-form-imgsrc">Path of image</label><input type="text" class="form-control" id="dnlv-podlozhka-form-imgsrc" placeholder="_podlozhka/img/img.png" value="_podlozhka/img/img.png"></div><div class="form-group"><label>Margins</label><div class="form-inline"><div class="input-group"><span class="input-group-addon">left:</span><input type="text" class="form-control" id="dnlv-podlozhka-form-imgx"><span class="input-group-addon">px</span></div><div class="input-group"><span class="input-group-addon">top:</span><input type="text" class="form-control" id="dnlv-podlozhka-form-imgy"><span class="input-group-addon">px</span></div></div></div></div></div></div>',c.css='<link rel="stylesheet" href="_podlozhka/podlozhka.min.css">',c.img_src="",a("body").append(c.html),a("head").append(c.css),c.body=a(".dnlv-podlozhka__body"),c.img_wrap=a(".dnlv-podlozhka__img"),d.img_src=a("#dnlv-podlozhka-form-imgsrc"),d.x=a("#dnlv-podlozhka-form-imgx"),d.y=a("#dnlv-podlozhka-form-imgy"),b.each(function(){var b,d=a(this);"script"!==d.nodeName&&(b=d.detach(),c.body.append(b))}),c.mouse_positions={x:0,y:0},c.img_positions={x:0,y:0},a(".on-off").on("click",function(){var b=a(this);b.hasClass("on-off_active")?(a(".dnlv-podlozhka__form .modal-body").hide(),b.removeClass("on-off_active"),c.img_wrap.show()):(a(".dnlv-podlozhka__form .modal-body").show(),b.addClass("on-off_active"),c.img_wrap.show())}),d.img_src.on("keyup",function(){c.img_src=d.img_src.val(),c.img_wrap.css({"background-image":"url("+c.img_src+")"}),e.mousedown=!1,f.changeImgPositions(c.mouse_positions.x,c.mouse_positions.y),c.img_wrap.on("mousedown",function(a){return e.mousedown?void 0:(e.mousedown=!0,c.mouse_positions.x=a.pageX,void(c.mouse_positions.y=a.pageY))}),c.img_wrap.on("mousemove",function(a){var b,d;e.mousedown&&(b=c.img_positions.x+(a.pageX-c.mouse_positions.x),d=c.img_positions.y+(a.pageY-c.mouse_positions.y),c.img_wrap.css({"background-position":b+"px "+d+"px"}))}),c.img_wrap.on("mouseup",function(){var a;return e.mousedown&&(e.mousedown=!1,a=c.img_wrap.css("background-position").match(/^([0-9\-\+\.]*)px ([0-9\-\+\.]*)px$/i))?(c.img_positions.x=parseFloat(a[1]),c.img_positions.y=parseFloat(a[2]),void f.changeImgPositions(a[1],a[2])):void 0})}),d.x.on("keyup",function(){c.img_positions.x=parseFloat(a(this).val()),c.img_wrap.css({"background-position":c.img_positions.x+"px "+c.img_positions.y+"px"})}),d.y.on("keyup",function(){c.img_positions.y=parseFloat(a(this).val()),c.img_wrap.css({"background-position":c.img_positions.x+"px "+c.img_positions.y+"px"})})}(jQuery);